<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temperature Schedule Manager</title>

    <!-- External Libraries -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- Favicons -->
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='favicon.png') }}">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/common.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/scheduler.css') }}">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“… Temperature Schedule Manager</h1>
            <p>Configure hour-by-hour temperature schedules for your smart heating system</p>

            <div class="status-indicators">
                <div class="status-indicator" id="mqtt-status">
                    <span>ğŸ”Œ</span> MQTT: <span id="mqtt-text">Connecting...</span>
                </div>
                <div class="status-indicator" id="db-status">
                    <span>ğŸ—„ï¸</span> Database: <span id="db-text">Connecting...</span>
                </div>
                <div class="status-indicator" id="nodes-status">
                    <span>ğŸ“¡</span> Nodes Online: <span id="nodes-count">0</span>
                </div>
                <div class="status-indicator" id="ai-status">
                    <span>ğŸ”¥</span> Heating System: <span id="ai-text">Initializing...</span>
                </div>
            </div>

            <div class="nav-links">
                <a href="/" class="nav-link">ğŸ“Š Dashboard</a>
                <a href="/analytics" class="nav-link">ğŸ“ˆ Analytics</a>
                <a href="/scheduler" class="nav-link active">ğŸ“… Scheduler</a>
            </div>
        </div>

        <!-- Schedule Management Controls -->
        <div class="card schedule-manager">
            <h3>ğŸ—‚ï¸ Schedule Management</h3>
            <div class="schedule-controls">
                <div class="control-row">
                    <div class="control-group">
                        <label for="schedule-name">Schedule Name:</label>
                        <input type="text" id="schedule-name" placeholder="My Custom Schedule" />
                    </div>
                    <div class="control-group">
                        <label for="schedule-description">Description:</label>
                        <input type="text" id="schedule-description" placeholder="Comfortable weekday schedule" />
                    </div>
                </div>

                <div class="control-row">
                    <div class="button-group">
                        <button class="btn btn-primary" onclick="saveSchedule()">ğŸ’¾ Save Schedule</button>
                        <button class="btn" onclick="loadSchedule()">ğŸ“‚ Load Schedule</button>
                        <button class="btn" onclick="resetSchedule()">ğŸ”„ Reset</button>
                        <button class="btn btn-success" onclick="applyToDevice()">ğŸ“¤ Apply to Device</button>
                        <button class="btn btn-success" onclick="applyToAllDevices()">ğŸ“¤ Apply to All</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Saved Schedules -->
        <div class="card saved-schedules">
            <h3>ğŸ“š Saved Schedules</h3>
            <div id="saved-schedules-list" class="schedules-list">
                <p class="loading">Loading schedules...</p>
            </div>
        </div>

        <!-- Quick Presets -->
        <div class="card quick-presets">
            <h3>âš¡ Quick Presets</h3>
            <div class="preset-buttons">
                <button class="btn preset-btn" onclick="loadPreset('comfort')">
                    ğŸ  Comfort<br><small>22Â°C day, 18Â°C night</small>
                </button>
                <button class="btn preset-btn" onclick="loadPreset('eco')">
                    ğŸŒ± Eco<br><small>20Â°C day, 16Â°C night</small>
                </button>
                <button class="btn preset-btn" onclick="loadPreset('work')">
                    ğŸ’¼ Work<br><small>22Â°C working hours</small>
                </button>
                <button class="btn preset-btn" onclick="loadPreset('away')">
                    âœˆï¸ Away<br><small>15Â°C constant</small>
                </button>
            </div>
        </div>

        <!-- Schedule Editor -->
        <div class="card schedule-editor">
            <h3>âœï¸ Schedule Editor</h3>
            <div class="editor-controls">
                <div class="control-group">
                    <label for="day-selector">Day:</label>
                    <select id="day-selector" onchange="switchDay()">
                        <option value="0">Monday</option>
                        <option value="1">Tuesday</option>
                        <option value="2">Wednesday</option>
                        <option value="3">Thursday</option>
                        <option value="4">Friday</option>
                        <option value="5">Saturday</option>
                        <option value="6">Sunday</option>
                    </select>
                </div>

                <div class="control-group">
                    <label>Quick Actions:</label>
                    <button class="btn btn-sm" onclick="copyDay()">ğŸ“‹ Copy Day</button>
                    <button class="btn btn-sm" onclick="pasteDay()">ğŸ“„ Paste Day</button>
                    <button class="btn btn-sm" onclick="fillDay()">ğŸ”¢ Fill Day</button>
                    <button class="btn btn-sm" onclick="copyWeekday()">ğŸ“… Copy to Weekdays</button>
                    <button class="btn btn-sm" onclick="copyWeekend()">ğŸ–ï¸ Copy to Weekend</button>
                </div>
            </div>

            <!-- Hour Grid -->
            <div class="hour-grid" id="hour-grid">
                <!-- Dynamically generated hour cells -->
            </div>

            <!-- Temperature Input -->
            <div class="temp-input-section">
                <label for="temp-input">Set Temperature (Â°C):</label>
                <input type="number" id="temp-input" min="10" max="30" step="0.5" value="20" />
                <button class="btn" onclick="applyTempToSelected()">âœ“ Apply</button>
                <div class="temp-range-info">
                    <span>Min: 10Â°C</span>
                    <span>Max: 30Â°C</span>
                    <span>Unset: 0</span>
                </div>
            </div>
        </div>

        <!-- Visual Week Overview -->
        <div class="card week-overview">
            <h3>ğŸ“Š Week Overview</h3>
            <canvas id="weekOverviewChart"></canvas>
        </div>

        <!-- Device Selection -->
        <div class="card device-selection">
            <h3>ğŸ“¡ Target Device</h3>
            <div id="device-list" class="device-list">
                <p class="loading">Loading devices...</p>
            </div>
        </div>

        <!-- Response Messages -->
        <div class="response-message" id="response-message"></div>

        <!-- Dark Mode Toggle -->
        <div class="dark-mode-toggle" onclick="toggleDarkMode()" title="Toggle Dark Mode">
            ğŸŒ™
        </div>
    </div>

    <!-- Include Chart.js for visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Custom JavaScript -->
    <script src="{{ url_for('static', filename='js/common.js') }}"></script>
    <script src="{{ url_for('static', filename='js/scheduler.js') }}"></script>
</body>
</html>
